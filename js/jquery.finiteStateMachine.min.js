/*
	Finite State Machine Plugin for jQuery (by Pedro Garcia)
	Version: 1.0
	http://phgarcia.com
	This plugin is offered under the MIT license.
	Copyright (c) 2017 Pedro Henrique Romaoli Garcia, http://phgarcia.mit-license.org
*/
!function(e){e.fn.finiteStateMachine=function(a){var t=e.extend({stateSelector:".fsm-state",nextSelector:".fsm-next",prevSelector:".fsm-prev",initialSelector:".fsm-initial",finalSelector:".fsm-final",fadeSpeed:300,linear:!1,before:null,after:null,callback:null},a),f=this,i=f.find(t.stateSelector),l=f.find(t.nextSelector),r=f.find(t.prevSelector),n=i.map(function(){return e(this).hide().data("state")}).get(),d=[];if(t.linear){var c=Math.min.apply(Math,n),o=Math.max.apply(Math,n),s=c;f.getState(s).show(),r.prop("disabled",!0),l.click(function(){t.before&&t.before(),r.prop("disabled",!1),f.getState(s).fadeOut(t.fadeSpeed,function(){do s++;while(0==f.getState(s).length);t.after&&t.after(),f.getState(s).fadeIn(t.fadeSpeed),s==o&&l.prop("disabled",!0),t.callback&&t.callback()})}),r.click(function(){t.before&&t.before(),l.prop("disabled",!1),f.getState(s).fadeOut(t.fadeSpeed,function(){do s--;while(0==f.getState(s).length);t.after&&t.after(),f.getState(s).fadeIn(t.fadeSpeed),s==c&&r.prop("disabled",!0),t.callback&&t.callback()})})}else{var p=f.find(t.initialSelector);p.show(),r.prop("disabled",!0),l.click(function(){t.before&&t.before(),d.push(p),r.prop("disabled",!1);var a=window[p.data("evaluator")]();p.fadeOut(t.fadeSpeed,function(){p=f.getState(a),t.after&&t.after(),p.fadeIn(t.fadeSpeed),e(t.finalSelector).is(p)&&l.prop("disabled",!0),t.callback&&t.callback()})}),r.click(function(){t.before&&t.before(),l.prop("disabled",!1);var a=d.pop();p.fadeOut(t.fadeSpeed,function(){p=a,t.after&&t.after(),p.fadeIn(t.fadeSpeed),e(t.initialSelector).is(p)&&r.prop("disabled",!0),t.callback&&t.callback()})})}f.addClass("fsmachined")},e.fn.getState=function(e){return this.find('.fsm-state[data-state="'+e+'"]')},e.fn.getCurrentState=function(){return this.find(".fsm-state:visible")}}(jQuery);
